# PushWorld PLR Training with Benchmark Puzzles Configuration
# 
# This config uses a FIXED BENCHMARK of puzzles instead of random generation.
# PLR prioritizes which puzzles to train on based on learning signal.
# All settings in one file (no defaults composition for compatibility)

# === BENCHMARK CONFIG ===
# Option 1: Load by name (auto-downloads from HuggingFace if needed)
# Available names: 'level0_transformed_all', 'level0_transformed_base', 'level0_mini'
benchmark_name: null  # Set to null when using benchmark_path

# Option 2: Load from explicit path (set benchmark_name to null to use this)
benchmark_path: ~/pushworld-experiments/pushworld_level0_transformed_all.pkl

# === Environment ===
env_name: pushworld
grid_size: 10
penalize_time: true
reward_shaping: false
max_steps_in_episode: 100

# === PPO Learning ===
lr: 1e-4
max_grad_norm: 0.5
num_steps: 256
num_train_envs: 32
num_minibatches: 1
gamma: 0.995
epoch_ppo: 5
clip_eps: 0.2
gae_lambda: 0.98
entropy_coeff: 1e-3
critic_coeff: 0.5

# === PLR (Prioritized Level Replay) ===
use_accel: false
exploratory_grad_updates: false
num_edits: 5
score_function: MaxMC  # MaxMC or pvl
level_buffer_capacity: 4000
replay_prob: 1.0  # Always replay (no DR since we don't generate new levels)
staleness_coeff: 0.3
temperature: 0.3
topk_k: 4
minimum_fill_ratio: 0.0  # Buffer is pre-filled, start replaying immediately
prioritization: rank  # rank or topk
buffer_duplicate_check: false  # No duplicates since we load fixed puzzles

# === Evaluation ===
eval_freq: 250
eval_num_attempts: 10
eval_levels:
  - TrivialPush
  - SimplePush
  - TwoGoals
  - ChainPush
  - WallMaze
  - Test131
  - Test22
  - Test23

# === Misc ===
seed: 0
use_wandb: true
wandb_project: pushworld-plr
wandb_entity: null
wandb_mode: online
save_path: checkpoints
save_policy: true
checkpoint_save_interval: 2
max_number_of_checkpoints: 60
mode: train  # train or eval
checkpoint_directory: null
checkpoint_to_eval: -1

# === Training ===
num_updates: 30000
run_name: pushworld_plr_benchmark